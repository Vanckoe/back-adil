{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"h1\", null, \"Категории\", -1 /* HOISTED */);\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [_hoisted_1, $data.isAdmin ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.newCategoryName = $event),\n    placeholder: \"Название новой категории\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.newCategoryName]]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.addCategory && $options.addCategory(...args))\n  }, \"Добавить Категорию\")])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.categories, category => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: category.id\n    }, [_createTextVNode(_toDisplayString(category.name) + \" \", 1 /* TEXT */), $data.isAdmin ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createElementVNode(\"button\", {\n      onClick: $event => $options.startEditCategory(category)\n    }, \"Изменить\", 8 /* PROPS */, _hoisted_4), _createElementVNode(\"button\", {\n      onClick: $event => $options.deleteCategory(category.id)\n    }, \"Удалить\", 8 /* PROPS */, _hoisted_5)])) : _createCommentVNode(\"v-if\", true)]);\n  }), 128 /* KEYED_FRAGMENT */))]), $data.selectedCategory ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.selectedCategory.name = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.selectedCategory.name]]), _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.confirmEditCategory && $options.confirmEditCategory(...args))\n  }, \"Сохранить изменения\"), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.cancelEditCategory && $options.cancelEditCategory(...args))\n  }, \"Отменить\")])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["_createElementVNode","_createElementBlock","_hoisted_1","$data","isAdmin","_hoisted_2","type","newCategoryName","$event","placeholder","onClick","_cache","args","$options","addCategory","_Fragment","_renderList","categories","category","key","id","name","_hoisted_3","startEditCategory","_hoisted_4","deleteCategory","_hoisted_5","selectedCategory","_hoisted_6","confirmEditCategory","cancelEditCategory"],"sources":["C:\\Users\\Vanckoe\\OneDrive\\Documents\\work\\Noncomercial\\lara\\crud\\src\\views\\CategoryData.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h1>Категории</h1>\r\n    <div v-if=\"isAdmin\">\r\n      <input type=\"text\" v-model=\"newCategoryName\" placeholder=\"Название новой категории\">\r\n      <button @click=\"addCategory\">Добавить Категорию</button>\r\n    </div>\r\n    <ul>\r\n      <li v-for=\"category in categories\" :key=\"category.id\">\r\n        {{ category.name }}\r\n        <div v-if=\"isAdmin\">\r\n          <button @click=\"startEditCategory(category)\">Изменить</button>\r\n          <button @click=\"deleteCategory(category.id)\">Удалить</button>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    <div v-if=\"selectedCategory\">\r\n      <input type=\"text\" v-model=\"selectedCategory.name\">\r\n      <button @click=\"confirmEditCategory\">Сохранить изменения</button>\r\n      <button @click=\"cancelEditCategory\">Отменить</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      categories: [],\r\n      newCategoryName: '',\r\n      isAdmin: false,\r\n      selectedCategory: null,\r\n    };\r\n  },\r\n  // created() {\r\n  //   this.checkUserRoleAndLoadCategories();\r\n  // },\r\n  methods: {\r\n    // async checkUserRoleAndLoadCategories() {\r\n    //   const token = localStorage.getItem('authToken');\r\n    //   if (!token) return;\r\n\r\n    //   try {\r\n    //     const rolesResponse = await this.$http.get('/roles', {\r\n    //       headers: { 'Authorization': `Bearer ${localStorage.getItem('authToken')}` }\r\n    //     })\r\n\r\n    //     this.isAdmin = rolesResponse.data.some(role => role.name === 'Admin');\r\n    //     this.loadCategories();\r\n    //   } catch (error) {\r\n    //     console.error('Ошибка при проверке роли пользователя:', error);\r\n    //   }\r\n    // },\r\n    async loadCategories() {\r\n      try {\r\n        const response = await this.$http.get('/category/categories');\r\n        this.categories = response.data;\r\n      } catch (error) {\r\n        console.error('Ошибка загрузки категорий:', error);\r\n      }\r\n    },\r\n    async addCategory() {\r\n      const token = localStorage.getItem('authToken');\r\n      try {\r\n        await this.$http.post('/category/categories', {\r\n          name: this.newCategoryName\r\n        }, {\r\n          headers: { 'Authorization': `Bearer ${token}` }\r\n        });\r\n        this.loadCategories();\r\n        this.newCategoryName = '';\r\n      } catch (error) {\r\n        if (error.response.status === 409) {\r\n          alert('Категория с таким именем уже существует');\r\n        } else {\r\n          console.error('Ошибка добавления категории:', error);\r\n        }\r\n      }\r\n    },\r\n    startEditCategory(category) {\r\n      this.selectedCategory = { ...category };\r\n    },\r\n    async confirmEditCategory() {\r\n      const token = localStorage.getItem('authToken');\r\n      try {\r\n        await this.$http.put(`/category/categories/${this.selectedCategory.id}`, {\r\n          name: this.selectedCategory.name\r\n        }, {\r\n          headers: { 'Authorization': `Bearer ${token}` }\r\n        });\r\n        this.loadCategories();\r\n        this.selectedCategory = null;\r\n      } catch (error) {\r\n        console.error('Ошибка редактирования категории:', error);\r\n      }\r\n    },\r\n    cancelEditCategory() {\r\n      this.selectedCategory = null;\r\n    },\r\n    async deleteCategory(id) {\r\n      const token = localStorage.getItem('authToken');\r\n      try {\r\n        await this.$http.delete(`/category/categories/${id}`, {\r\n          headers: { 'Authorization': `Bearer ${token}` }\r\n        });\r\n        this.loadCategories();\r\n      } catch (error) {\r\n        console.error('Ошибка удаления категории:', error);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>"],"mappings":";gCAEIA,mBAAA,CAAkB,YAAd,WAAS;;;;;;;;;;;;;uBADfC,mBAAA,CAoBM,cAnBJC,UAAkB,EACPC,KAAA,CAAAC,OAAO,I,cAAlBH,mBAAA,CAGM,OAAAI,UAAA,G,gBAFJL,mBAAA,CAAoF;IAA7EM,IAAI,EAAC,MAAM;+DAAUH,KAAA,CAAAI,eAAe,GAAAC,MAAA;IAAEC,WAAW,EAAC;iDAA7BN,KAAA,CAAAI,eAAe,E,GAC3CP,mBAAA,CAAwD;IAA/CU,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,WAAA,IAAAD,QAAA,CAAAC,WAAA,IAAAF,IAAA,CAAW;KAAE,oBAAkB,E,wCAEjDZ,mBAAA,CAQK,c,kBAPHC,mBAAA,CAMKc,SAAA,QAAAC,WAAA,CANkBb,KAAA,CAAAc,UAAU,EAAtBC,QAAQ;yBAAnBjB,mBAAA,CAMK;MAN+BkB,GAAG,EAAED,QAAQ,CAACE;0CAC7CF,QAAQ,CAACG,IAAI,IAAG,GACnB,iBAAWlB,KAAA,CAAAC,OAAO,I,cAAlBH,mBAAA,CAGM,OAAAqB,UAAA,GAFJtB,mBAAA,CAA8D;MAArDU,OAAK,EAAAF,MAAA,IAAEK,QAAA,CAAAU,iBAAiB,CAACL,QAAQ;OAAG,UAAQ,iBAAAM,UAAA,GACrDxB,mBAAA,CAA6D;MAApDU,OAAK,EAAAF,MAAA,IAAEK,QAAA,CAAAY,cAAc,CAACP,QAAQ,CAACE,EAAE;OAAG,SAAO,iBAAAM,UAAA,E;oCAI/CvB,KAAA,CAAAwB,gBAAgB,I,cAA3B1B,mBAAA,CAIM,OAAA2B,UAAA,G,gBAHJ5B,mBAAA,CAAmD;IAA5CM,IAAI,EAAC,MAAM;+DAAUH,KAAA,CAAAwB,gBAAgB,CAACN,IAAI,GAAAb,MAAA;iDAArBL,KAAA,CAAAwB,gBAAgB,CAACN,IAAI,E,GACjDrB,mBAAA,CAAiE;IAAxDU,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAgB,mBAAA,IAAAhB,QAAA,CAAAgB,mBAAA,IAAAjB,IAAA,CAAmB;KAAE,qBAAmB,GACxDZ,mBAAA,CAAqD;IAA5CU,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAiB,kBAAA,IAAAjB,QAAA,CAAAiB,kBAAA,IAAAlB,IAAA,CAAkB;KAAE,UAAQ,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}